package org.netcomputing.webservices.database;

import java.net.UnknownHostException;

import com.mongodb.DB;
import com.mongodb.MongoClient;
import org.netcomputing.webservices.server.ConfigLoader;

public enum UserRepository {
	
	/**
	 * The (unique) instance of MongoDB
	 */
	instance;
	     
	/**
	 * The abstraction of a (concrete) database
	 */
	private static DB db ;
	
	/**
	 * The mongoClient that connects to a database instance
	 * @see https://docs.mongodb.org/getting-started/java/client/
	 */
	private static MongoClient mongoClient;


	private UserRepository() {
		// Initializes the connection?
	}
	 
	public DB getDB() {
		if (mongoClient == null) {
			try {
				mongoClient = new MongoClient(ConfigLoader.getDBHost(), ConfigLoader.getDBPort());
			} catch (UnknownHostException e) {
				System.out.println("Error. Impossible to create MongoClient; track: " + e);
			return null;
			}
		}
		if (db == null) {
			db = mongoClient.getDB(ConfigLoader.getDBName());
		}
		return db;
	}

}
